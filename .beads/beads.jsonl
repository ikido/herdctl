{"id":"herdctl-001","title":"Config Parsing Foundation","description":"Implement the configuration parsing foundation for herdctl in packages/core/src/config/. This module parses and validates fleet configuration (herdctl.yaml) and individual agent YAML files, providing a type-safe, validated configuration object for the rest of the system.","status":"tombstone","priority":0,"issue_type":"task","created_at":"2026-01-19T16:32:24.448999-05:00","updated_at":"2026-01-19T16:34:57.975682-05:00","labels":["feature","ralph"],"deleted_at":"2026-01-19T16:34:57.975682-05:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"herdctl-002","title":"US-1: Parse Fleet Configuration","description":"As a fleet operator, I want to load a herdctl.yaml file so that I can define my fleet's default settings and agent references.\n\n## Acceptance Criteria\n- [ ] Parses valid herdctl.yaml files using the yaml package\n- [ ] Returns typed FleetConfig object validated by Zod\n- [ ] Throws descriptive errors for invalid YAML syntax\n- [ ] Throws descriptive errors for schema validation failures\n- [ ] Supports all fields from SPEC.md: fleet, defaults, agents, workspace, chat, webhooks, docker\n- [ ] pnpm typecheck passes in packages/core\n- [ ] pnpm test passes with tests for this functionality","status":"tombstone","priority":1,"issue_type":"task","created_at":"2026-01-19T16:32:24.448999-05:00","updated_at":"2026-01-19T16:34:57.975682-05:00","labels":["ralph","task"],"deleted_at":"2026-01-19T16:34:57.975682-05:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"herdctl-003","title":"US-2: Parse Agent Configuration","description":"As a fleet operator, I want to define agents in separate YAML files so that I can organize my agent configurations modularly.\n\n## Acceptance Criteria\n- [ ] Parses agent YAML files referenced by path in fleet config\n- [ ] Returns typed AgentConfig object validated by Zod\n- [ ] Supports all agent fields: name, description, workspace, repo, identity, work_source, schedules, session, permissions, mcp_servers, chat\n- [ ] Handles relative paths resolved from fleet config location\n- [ ] Throws descriptive errors with file path context\n- [ ] pnpm typecheck passes in packages/core\n- [ ] pnpm test passes with tests for this functionality","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-01-19T16:32:24.448999-05:00","updated_at":"2026-01-19T16:34:57.975682-05:00","labels":["ralph","task"],"deleted_at":"2026-01-19T16:34:57.975682-05:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"herdctl-004","title":"US-3: Merge Defaults with Agent Overrides","description":"As a fleet operator, I want to define fleet-level defaults that agents can override so that I don't repeat common configuration across agents.\n\n## Acceptance Criteria\n- [ ] Fleet defaults section merges into each agent config\n- [ ] Agent-specific values override fleet defaults (deep merge)\n- [ ] Merge applies to: permissions, work_source, session, docker, model, max_turns, permission_mode\n- [ ] Nested objects merge recursively (e.g., permissions.allowed_tools)\n- [ ] Arrays are replaced, not merged (agent's allowed_tools replaces defaults)\n- [ ] pnpm typecheck passes in packages/core\n- [ ] pnpm test passes with tests for this functionality","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-01-19T16:32:24.448999-05:00","updated_at":"2026-01-19T16:34:57.975682-05:00","labels":["ralph","task"],"deleted_at":"2026-01-19T16:34:57.975682-05:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"herdctl-005","title":"US-4: Environment Variable Interpolation","description":"As a fleet operator, I want to use ${VAR} syntax in YAML values so that I can inject secrets and environment-specific values.\n\n## Acceptance Criteria\n- [ ] Interpolates ${VAR_NAME} patterns in string values\n- [ ] Supports ${VAR:-default} syntax for default values\n- [ ] Throws error for undefined variables without defaults\n- [ ] Preserves non-string values (numbers, booleans, objects)\n- [ ] Works at any nesting depth in the config\n- [ ] pnpm typecheck passes in packages/core\n- [ ] pnpm test passes with tests for this functionality","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-01-19T16:32:24.448999-05:00","updated_at":"2026-01-19T16:34:57.975682-05:00","labels":["ralph","task"],"deleted_at":"2026-01-19T16:34:57.975682-05:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"herdctl-006","title":"US-5: Load Complete Configuration","description":"As a developer using @herdctl/core, I want to call a single function to load all config so that I get a fully resolved, validated configuration object.\n\n## Acceptance Criteria\n- [ ] loadConfig(configPath?: string) function auto-discovers herdctl.yaml\n- [ ] Searches current directory and parents (like git does)\n- [ ] Loads fleet config, all referenced agents, merges defaults\n- [ ] Returns ResolvedConfig with all agents fully resolved\n- [ ] Validates entire config tree before returning\n- [ ] Can load examples/simple/herdctl.yaml and resolve all agents\n- [ ] pnpm typecheck passes in packages/core\n- [ ] pnpm test passes with \u003e90% coverage of config module","status":"tombstone","priority":3,"issue_type":"task","created_at":"2026-01-19T16:32:24.448999-05:00","updated_at":"2026-01-19T16:34:57.975682-05:00","labels":["ralph","task"],"deleted_at":"2026-01-19T16:34:57.975682-05:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"herdctl-08c","title":"Config Parsing Foundation","description":"Implement the configuration parsing foundation for herdctl in packages/core/src/config/. This module parses and validates fleet configuration (herdctl.yaml) and individual agent YAML files, providing a type-safe, validated configuration object for the rest of the system.","status":"closed","priority":0,"issue_type":"epic","owner":"ed@edspencer.net","created_at":"2026-01-19T16:35:05.79657-05:00","created_by":"Ed Spencer","updated_at":"2026-01-19T17:15:23.987874-05:00","closed_at":"2026-01-19T17:15:23.987874-05:00","close_reason":"Closed","external_ref":"prd:./tasks/config-parsing-prd.md","labels":["feature","ralph"]}
{"id":"herdctl-08c.1","title":"US-1: Parse Fleet Configuration","description":"As a fleet operator, I want to load a herdctl.yaml file so that I can define my fleet's default settings and agent references.\n\n## Acceptance Criteria\n- [ ] Parses valid herdctl.yaml files using the yaml package\n- [ ] Returns typed FleetConfig object validated by Zod\n- [ ] Throws descriptive errors for invalid YAML syntax\n- [ ] Throws descriptive errors for schema validation failures\n- [ ] Supports all fields from SPEC.md: fleet, defaults, agents, workspace, chat, webhooks, docker\n- [ ] pnpm typecheck passes in packages/core\n- [ ] pnpm test passes with \u003e90% coverage of config module","status":"closed","priority":1,"issue_type":"task","owner":"ed@edspencer.net","created_at":"2026-01-19T16:35:24.07093-05:00","created_by":"Ed Spencer","updated_at":"2026-01-19T16:45:38.811398-05:00","closed_at":"2026-01-19T16:45:38.811398-05:00","close_reason":"Completed by agent","labels":["ralph","task"],"dependencies":[{"issue_id":"herdctl-08c.1","depends_on_id":"herdctl-08c","type":"parent-child","created_at":"2026-01-19T16:35:24.071451-05:00","created_by":"Ed Spencer"}]}
{"id":"herdctl-08c.2","title":"US-2: Parse Agent Configuration","description":"As a fleet operator, I want to define agents in separate YAML files so that I can organize my agent configurations modularly.\n\n## Acceptance Criteria\n- [ ] Parses agent YAML files referenced by path in fleet config\n- [ ] Returns typed AgentConfig object validated by Zod\n- [ ] Supports all agent fields: name, description, workspace, repo, identity, work_source, schedules, session, permissions, mcp_servers, chat\n- [ ] Handles relative paths resolved from fleet config location\n- [ ] Throws descriptive errors with file path context\n- [ ] pnpm typecheck passes in packages/core\n- [ ] pnpm test passes with \u003e90% coverage of config module","status":"closed","priority":2,"issue_type":"task","owner":"ed@edspencer.net","created_at":"2026-01-19T16:35:32.594497-05:00","created_by":"Ed Spencer","updated_at":"2026-01-19T16:49:48.666339-05:00","closed_at":"2026-01-19T16:49:48.666339-05:00","close_reason":"Completed by agent","labels":["ralph","task"],"dependencies":[{"issue_id":"herdctl-08c.2","depends_on_id":"herdctl-08c","type":"parent-child","created_at":"2026-01-19T16:35:32.594991-05:00","created_by":"Ed Spencer"},{"issue_id":"herdctl-08c.2","depends_on_id":"herdctl-08c.1","type":"blocks","created_at":"2026-01-19T16:36:07.490289-05:00","created_by":"Ed Spencer"}]}
{"id":"herdctl-08c.3","title":"US-3: Merge Defaults with Agent Overrides","description":"As a fleet operator, I want to define fleet-level defaults that agents can override so that I don't repeat common configuration across agents.\n\n## Acceptance Criteria\n- [ ] Fleet defaults section merges into each agent config\n- [ ] Agent-specific values override fleet defaults (deep merge)\n- [ ] Merge applies to: permissions, work_source, session, docker, model, max_turns, permission_mode\n- [ ] Nested objects merge recursively (e.g., permissions.allowed_tools)\n- [ ] Arrays are replaced, not merged (agent's allowed_tools replaces defaults)\n- [ ] pnpm typecheck passes in packages/core\n- [ ] pnpm test passes with \u003e90% coverage of config module","status":"closed","priority":2,"issue_type":"task","owner":"ed@edspencer.net","created_at":"2026-01-19T16:35:40.858149-05:00","created_by":"Ed Spencer","updated_at":"2026-01-19T16:55:12.359393-05:00","closed_at":"2026-01-19T16:55:12.359393-05:00","close_reason":"Completed by agent","labels":["ralph","task"],"dependencies":[{"issue_id":"herdctl-08c.3","depends_on_id":"herdctl-08c","type":"parent-child","created_at":"2026-01-19T16:35:40.858665-05:00","created_by":"Ed Spencer"},{"issue_id":"herdctl-08c.3","depends_on_id":"herdctl-08c.1","type":"blocks","created_at":"2026-01-19T16:36:09.87234-05:00","created_by":"Ed Spencer"},{"issue_id":"herdctl-08c.3","depends_on_id":"herdctl-08c.2","type":"blocks","created_at":"2026-01-19T16:36:09.932272-05:00","created_by":"Ed Spencer"}]}
{"id":"herdctl-08c.4","title":"US-4: Environment Variable Interpolation","description":"As a fleet operator, I want to use ${VAR} syntax in YAML values so that I can inject secrets and environment-specific values.\n\n## Acceptance Criteria\n- [ ] Interpolates ${VAR_NAME} patterns in string values\n- [ ] Supports ${VAR:-default} syntax for default values\n- [ ] Throws error for undefined variables without defaults\n- [ ] Preserves non-string values (numbers, booleans, objects)\n- [ ] Works at any nesting depth in the config\n- [ ] pnpm typecheck passes in packages/core\n- [ ] pnpm test passes with \u003e90% coverage of config module","status":"closed","priority":2,"issue_type":"task","owner":"ed@edspencer.net","created_at":"2026-01-19T16:35:47.087373-05:00","created_by":"Ed Spencer","updated_at":"2026-01-19T16:58:00.83921-05:00","closed_at":"2026-01-19T16:58:00.83921-05:00","close_reason":"Completed by agent","labels":["ralph","task"],"dependencies":[{"issue_id":"herdctl-08c.4","depends_on_id":"herdctl-08c","type":"parent-child","created_at":"2026-01-19T16:35:47.08787-05:00","created_by":"Ed Spencer"},{"issue_id":"herdctl-08c.4","depends_on_id":"herdctl-08c.1","type":"blocks","created_at":"2026-01-19T16:36:11.301987-05:00","created_by":"Ed Spencer"}]}
{"id":"herdctl-08c.5","title":"US-5: Load Complete Configuration","description":"As a developer using @herdctl/core, I want to call a single function to load all config so that I get a fully resolved, validated configuration object.\n\n## Acceptance Criteria\n- [ ] loadConfig(configPath?: string) function auto-discovers herdctl.yaml\n- [ ] Searches current directory and parents (like git does)\n- [ ] Loads fleet config, all referenced agents, merges defaults\n- [ ] Returns ResolvedConfig with all agents fully resolved\n- [ ] Validates entire config tree before returning\n- [ ] pnpm typecheck passes in packages/core\n- [ ] pnpm test passes with \u003e90% coverage of config module","status":"closed","priority":3,"issue_type":"task","owner":"ed@edspencer.net","created_at":"2026-01-19T16:35:53.473938-05:00","created_by":"Ed Spencer","updated_at":"2026-01-19T17:03:13.886438-05:00","closed_at":"2026-01-19T17:03:13.886438-05:00","close_reason":"Completed by agent","labels":["ralph","task"],"dependencies":[{"issue_id":"herdctl-08c.5","depends_on_id":"herdctl-08c","type":"parent-child","created_at":"2026-01-19T16:35:53.4744-05:00","created_by":"Ed Spencer"},{"issue_id":"herdctl-08c.5","depends_on_id":"herdctl-08c.3","type":"blocks","created_at":"2026-01-19T16:36:12.905191-05:00","created_by":"Ed Spencer"},{"issue_id":"herdctl-08c.5","depends_on_id":"herdctl-08c.4","type":"blocks","created_at":"2026-01-19T16:36:12.965556-05:00","created_by":"Ed Spencer"}]}
{"id":"herdctl-3ay","title":"State Management Foundation","description":"Implement the state management foundation for herdctl in packages/core/src/state/. This module manages the .herdctl/ directory structure, providing persistent storage for fleet state, job metadata, job output logs, agent sessions, and runtime information. All state is file-based (no database required), using YAML for structured data and JSONL for streaming logs.","status":"open","priority":2,"issue_type":"epic","owner":"ed@edspencer.net","created_at":"2026-01-19T17:30:18.317057-05:00","created_by":"Ed Spencer","updated_at":"2026-01-19T17:30:18.317057-05:00","external_ref":"prd:./tasks/prd-prd-2-state-management.md","labels":["feature","ralph"]}
{"id":"herdctl-3ay.1","title":"US-1: Initialize State Directory Structure","description":"As a fleet operator, I want to have herdctl automatically create and manage the .herdctl/ directory so that all state files are organized and accessible.\n\n## Acceptance Criteria\n- [ ] Creates .herdctl/ directory in the project root if it doesn't exist\n- [ ] Creates subdirectories: jobs/, sessions/, logs/\n- [ ] Creates state.yaml with empty/initial fleet state if it doesn't exist\n- [ ] Validates directory structure on initialization\n- [ ] Returns StateDirectory object with paths to all subdirectories\n- [ ] Throws descriptive errors if directories cannot be created (e.g., permission denied)\n- [ ] Supports custom state directory path via options (default: .herdctl/ in CWD)\n\n## Quality Gates\n- [ ] pnpm typecheck passes in packages/core\n- [ ] pnpm test passes with \u003e90% coverage of state module","status":"open","priority":1,"issue_type":"task","owner":"ed@edspencer.net","created_at":"2026-01-19T17:30:25.740138-05:00","created_by":"Ed Spencer","updated_at":"2026-01-19T17:30:25.740138-05:00","labels":["ralph","task"],"dependencies":[{"issue_id":"herdctl-3ay.1","depends_on_id":"herdctl-3ay","type":"parent-child","created_at":"2026-01-19T17:30:25.740735-05:00","created_by":"Ed Spencer"},{"issue_id":"herdctl-3ay.1","depends_on_id":"herdctl-3ay.5","type":"blocks","created_at":"2026-01-19T17:31:13.440634-05:00","created_by":"Ed Spencer"},{"issue_id":"herdctl-3ay.1","depends_on_id":"herdctl-3ay.7","type":"blocks","created_at":"2026-01-19T17:31:13.51583-05:00","created_by":"Ed Spencer"}]}
{"id":"herdctl-3ay.2","title":"US-2: Read/Write Fleet State (state.yaml)","description":"As a fleet operator, I want to persist fleet-wide state across restarts so that agents resume from their last known state.\n\n## Acceptance Criteria\n- [ ] Reads state.yaml and validates against FleetStateSchema\n- [ ] Returns typed FleetState object with:\n  - fleet.started_at - when the fleet was started\n  - agents - map of agent name to AgentState (status, current_job, last_job, next_schedule, next_trigger_at, container_id, error_message)\n- [ ] Writes FleetState back to state.yaml atomically\n- [ ] Handles missing file gracefully (returns default empty state)\n- [ ] Handles corrupted file gracefully (logs warning, returns default state)\n- [ ] Provides updateAgentState(agentName, updates) for partial updates\n\n## Quality Gates\n- [ ] pnpm typecheck passes in packages/core\n- [ ] pnpm test passes with \u003e90% coverage of state module","status":"open","priority":1,"issue_type":"task","owner":"ed@edspencer.net","created_at":"2026-01-19T17:30:32.287745-05:00","created_by":"Ed Spencer","updated_at":"2026-01-19T17:30:32.287745-05:00","labels":["ralph","task"],"dependencies":[{"issue_id":"herdctl-3ay.2","depends_on_id":"herdctl-3ay","type":"parent-child","created_at":"2026-01-19T17:30:32.288291-05:00","created_by":"Ed Spencer"},{"issue_id":"herdctl-3ay.2","depends_on_id":"herdctl-3ay.1","type":"blocks","created_at":"2026-01-19T17:31:17.566743-05:00","created_by":"Ed Spencer"}]}
{"id":"herdctl-3ay.3","title":"US-3: Read/Write Job Metadata (job-\u003cid\u003e.yaml)","description":"As a fleet operator, I want to persist job metadata for history and debugging so that I can track what each job did and when.\n\n## Acceptance Criteria\n- [ ] Creates job metadata file at .herdctl/jobs/job-\u003cid\u003e.yaml\n- [ ] Validates against JobMetadataSchema with fields: id, agent, schedule, trigger_type, status, exit_reason, session_id, forked_from, started_at, finished_at, duration_seconds, prompt, summary, output_file\n- [ ] Provides createJob(), updateJob(), getJob(), listJobs() functions\n- [ ] updateJob() uses atomic writes to prevent corruption\n- [ ] listJobs() supports filtering by agent, status, and date range\n- [ ] Generates unique job IDs with format: job-YYYY-MM-DD-\u003crandom6\u003e\n\n## Quality Gates\n- [ ] pnpm typecheck passes in packages/core\n- [ ] pnpm test passes with \u003e90% coverage of state module","status":"open","priority":2,"issue_type":"task","owner":"ed@edspencer.net","created_at":"2026-01-19T17:30:38.751256-05:00","created_by":"Ed Spencer","updated_at":"2026-01-19T17:30:38.751256-05:00","labels":["ralph","task"],"dependencies":[{"issue_id":"herdctl-3ay.3","depends_on_id":"herdctl-3ay","type":"parent-child","created_at":"2026-01-19T17:30:38.751858-05:00","created_by":"Ed Spencer"},{"issue_id":"herdctl-3ay.3","depends_on_id":"herdctl-3ay.1","type":"blocks","created_at":"2026-01-19T17:31:21.239569-05:00","created_by":"Ed Spencer"}]}
{"id":"herdctl-3ay.4","title":"US-4: Append to Job Output Logs (job-\u003cid\u003e.jsonl)","description":"As a fleet operator, I want to stream job output to a persistent log file so that I can replay, monitor, and debug job execution.\n\n## Acceptance Criteria\n- [ ] Creates output file at .herdctl/jobs/job-\u003cid\u003e.jsonl\n- [ ] Appends JSONL messages from Claude SDK streaming output\n- [ ] Each line is a valid JSON object with at minimum: type, timestamp\n- [ ] Supports SDK message types: system, assistant, tool_use, tool_result, error\n- [ ] Provides appendJobOutput(jobId, message) function (single message)\n- [ ] Provides appendJobOutputBatch(jobId, messages) function (multiple messages)\n- [ ] Provides readJobOutput(jobId) async generator for streaming reads\n- [ ] Provides getJobOutputPath(jobId) for direct file access\n- [ ] Handles concurrent appends safely (uses append mode)\n- [ ] Validates message structure before writing\n- [ ] Does NOT buffer - writes immediately for real-time monitoring\n\n## Quality Gates\n- [ ] pnpm typecheck passes in packages/core\n- [ ] pnpm test passes with \u003e90% coverage of state module","status":"open","priority":2,"issue_type":"task","owner":"ed@edspencer.net","created_at":"2026-01-19T17:30:45.988252-05:00","created_by":"Ed Spencer","updated_at":"2026-01-19T17:30:45.988252-05:00","labels":["ralph","task"],"dependencies":[{"issue_id":"herdctl-3ay.4","depends_on_id":"herdctl-3ay","type":"parent-child","created_at":"2026-01-19T17:30:45.988821-05:00","created_by":"Ed Spencer"},{"issue_id":"herdctl-3ay.4","depends_on_id":"herdctl-3ay.3","type":"blocks","created_at":"2026-01-19T17:31:25.515873-05:00","created_by":"Ed Spencer"}]}
{"id":"herdctl-3ay.5","title":"US-5: Atomic Writes to Prevent Corruption","description":"As a fleet operator, I want to ensure state files are never corrupted during writes so that my fleet state survives crashes and restarts.\n\n## Acceptance Criteria\n- [ ] All YAML writes use atomic write pattern (write to temp file, then rename)\n- [ ] Temp files are written to same directory as target (ensures same filesystem)\n- [ ] Temp files use pattern: .\u003cfilename\u003e.tmp.\u003crandom\u003e\n- [ ] Rename operation is atomic on POSIX systems\n- [ ] On Windows, uses rename with retry logic for best-effort atomicity\n- [ ] JSONL appends use fs.appendFile (atomic at message level on most systems)\n- [ ] Provides atomicWriteFile(path, content) utility function\n- [ ] Cleans up temp files on failure\n\n## Quality Gates\n- [ ] pnpm typecheck passes in packages/core\n- [ ] pnpm test passes with \u003e90% coverage of state module","status":"open","priority":1,"issue_type":"task","owner":"ed@edspencer.net","created_at":"2026-01-19T17:30:54.547598-05:00","created_by":"Ed Spencer","updated_at":"2026-01-19T17:30:54.547598-05:00","labels":["ralph","task"],"dependencies":[{"issue_id":"herdctl-3ay.5","depends_on_id":"herdctl-3ay","type":"parent-child","created_at":"2026-01-19T17:30:54.548157-05:00","created_by":"Ed Spencer"}]}
{"id":"herdctl-3ay.6","title":"US-6: Session State Management","description":"As a fleet operator, I want to persist Claude session information per agent so that I can resume or fork sessions later.\n\n## Acceptance Criteria\n- [ ] Stores session info at .herdctl/sessions/\u003cagent-name\u003e.json\n- [ ] Validates against SessionInfoSchema with fields: agent_name, session_id, created_at, last_used_at, job_count, mode\n- [ ] Provides getSessionInfo(agentName), updateSessionInfo(agentName, info), clearSession(agentName)\n- [ ] Handles missing file gracefully (returns null)\n\n## Quality Gates\n- [ ] pnpm typecheck passes in packages/core\n- [ ] pnpm test passes with \u003e90% coverage of state module","status":"open","priority":2,"issue_type":"task","owner":"ed@edspencer.net","created_at":"2026-01-19T17:30:59.964751-05:00","created_by":"Ed Spencer","updated_at":"2026-01-19T17:30:59.964751-05:00","labels":["ralph","task"],"dependencies":[{"issue_id":"herdctl-3ay.6","depends_on_id":"herdctl-3ay","type":"parent-child","created_at":"2026-01-19T17:30:59.965374-05:00","created_by":"Ed Spencer"},{"issue_id":"herdctl-3ay.6","depends_on_id":"herdctl-3ay.1","type":"blocks","created_at":"2026-01-19T17:31:29.978005-05:00","created_by":"Ed Spencer"}]}
{"id":"herdctl-3ay.7","title":"US-7: Concurrent Read Safety","description":"As a fleet operator, I want to read state from multiple CLI instances simultaneously so that I can monitor agents while they're running.\n\n## Acceptance Criteria\n- [ ] Read operations don't require locks\n- [ ] Read operations handle file being written to (retry on partial read)\n- [ ] YAML parsing handles empty/truncated files gracefully\n- [ ] JSONL reading handles incomplete last line (truncates to last valid line)\n- [ ] Provides safeReadYaml(path) utility with retry logic\n- [ ] Provides safeReadJsonl(path) utility that handles partial lines\n\n## Quality Gates\n- [ ] pnpm typecheck passes in packages/core\n- [ ] pnpm test passes with \u003e90% coverage of state module","status":"open","priority":2,"issue_type":"task","owner":"ed@edspencer.net","created_at":"2026-01-19T17:31:06.104554-05:00","created_by":"Ed Spencer","updated_at":"2026-01-19T17:31:06.104554-05:00","labels":["ralph","task"],"dependencies":[{"issue_id":"herdctl-3ay.7","depends_on_id":"herdctl-3ay","type":"parent-child","created_at":"2026-01-19T17:31:06.105134-05:00","created_by":"Ed Spencer"}]}
